对我来说，电脑和手机已经成为了生活的必需品，每天不玩几次，生活的幸福感直线下降。今天钻个牛角尖，说说电脑开机的时候，大概都做了些什么。


你说你要钻我的角尖？

之所以说大概做了些什么，是因为，想研究明白电脑开机的整个过程，实在是太难了，我只能研究个大概。如果要深入硬件的底层，这已经远远超出了我的能力范围。所以，即使我讲完了，具体的细节，我仍然不清楚。如果对电脑很感兴趣的读者，非常建议买沃兹的自传过来看看，这个人和乔布斯共同创建了苹果公司，他自己一个人搞定了苹果最初的两代电脑，没人能帮上忙，乔布斯帮他买饮料，就他自己一个人搞技术。这个老技术宅男在他的自传里大谈技术，什么晶体管，逻辑门，结果这本自传的销量非常惨淡，是乔布斯自传的万分之一。


沃兹自传，销量高达乔布斯自传的万分之一

开机第一步：按电源

当我们在开机按钮上按一下，实际上是对主板上的两根阵脚进行了短路。如果买电脑配件自己安装的话，在没有安装机箱的情况下，可以拿螺丝刀或者一根金属在主板上的两根针脚上短路一下，电脑也可以开机。

当主板收到开机信号，电路开始接通，电脑里有电源，源源不断的将220V的市电（交流电）转换成3.3V，5V和12V的直流电，这三种电压是电脑里最常用的三种电压。如果是笔记本电脑，电池里的电压也需要转换成这三种常用电压。

然后，能看到显示器上显示一些东西。比如品牌机可能会显示自己的LOGO，如果是自己组装的电脑，可能会显示主板的LOGO，有一些电脑还会显示能源之星的一个LOGO，或者外加一长串快速滚动的字符，也看不清楚。

在这个阶段，电脑还没有被操作系统控制，因此无论电脑安装的是Linux操作系统，还是Windows操作系统，看到的界面都是一样的。

软件和硬件的区别

先来说一下软件和硬件的区别，形象的来说，如果你手里有一把锤子，能敲碎的，就是硬件，比如显示器，键盘，鼠标以及主板等等。软件呢，则是依附于硬件，我们日常所说的软件，都是可以买光盘来装，或者通过网络下载的，软件没法敲碎，写到这里，突然想到了一部电影《V字仇杀队》，里面的一句台词：

我亲眼目睹过思想的力量，我见过人们以它为名乱杀无辜，为维护他而丢掉性命，但是你不能杀死思想，你不能触摸他或者捧着他，思想不会流血，不会感到痛苦，思想不会死去。


面具下的思想永存

这里的软件有点像思想。对非程序员很难形容软件是什么，但是，我们程序员都应该能理解软件是什么。对外行人也很难描述我们程序员的工作，我是程序员，朋友对我的误解就很多，有人认为我是修电脑的，还有人问我能不能给她冲一万个QQ币，我说这个真不行，她反问，你不是程序员么？

但是软件又必须依附于硬件，主板上有一个很重要的芯片，原来他的名字叫BIOS，现在他经过了升级，改名字了，名字叫UEFI。这是一块焊接在主板上的芯片，芯片里固化了软件。这个芯片对整个电脑极其重要。

如果要类比的话，类似于大脑中的神经中枢，控制人的呼吸，心跳等基础功能。这种基础功能，人是没法干预的。比如说，人不可能控制住自己不呼吸，然后把自己憋死，除非借助外力，比如说上吊。前段时间不就是有个神剧，里面有个哥们自杀，憋气，把自己憋死了，他憋死了，把我笑死了。还有人也不能控制心跳，比如说，你不可能对心脏说，别跳了，这个不属于人的意识能控制的范围。

BIOS和UEFI的区别

主板上的BIOS和UEFI，就是提供和呼吸，心跳类似的基础功能，比如说，提供中断，大家如果学习过计算机课程，应该知道中断的概念，没有中断，电脑只能进出，不能中断的话，键盘鼠标都用不了，根本不能愉快的玩耍了。

如何区分BIOS和UEFI呢？其实也很简单，如果是新电脑，基本上就是UEFI，如果是旧电脑，那很有可能是BIOS。详细来说，BIOS的用户界面是蓝屏加上字符的，UEFI的用户界面有图形，还能使用鼠标，而且那些图像还有动画效果，比如一个小风扇转动。这个也不一定，我见过BIOS能使用鼠标的，而且BIOS也更新了好几代，不过大体来说，新电脑肯定是UEFI。


UEFI用户界面

我又想到了一个事儿，看电影的时候，为了突出黑客厉害，在里面的黑客入侵某个机密数据的时候，好莱坞电影里的黑客使用的肯定都不是windows或者mac，也一般不用Linux，那容易让观众出戏，因为这几种系统相对来说太普遍，如果一个黑客打开一个windows xp，然后开个IE浏览器或者开个cmd的命令行，我们是不是觉得这个黑客low爆了。后来我在Quora上查过这个问题，众说纷纭，不过，我比较认同说那就是动画，做好的动画，在屏幕上播放。记得大学时候有一次我看的电视剧，忘记哪个电视剧了，好像是香港的电视剧，里面说黑客的时候，我一看，我去，连动画都不设置，就是在BIOS界面。当时还挺紧张的，一看到BIOS界面，然后瞬间让我出戏了。


BIOS用户界面

硬件自检阶段

无论电脑用的是BIOS还是UEFI，都要有一个阶段叫硬件自检，如果这里面的硬件都没啥毛病，电脑会最终叮的一声，算是自检通过。但是现在有一些机箱，为了节省成本，比如说我买的一个酷冷至尊毁灭者二代机箱，就没有这个蜂鸣器，开机悄无声息的，哑巴一样。 如果自检的时候，没通过，比如内存，显卡这些东西坏了，或者松了，这些蜂鸣器就叮叮叮的叫，而且是有规律的叫，内存怎么叫，显卡怎么叫都有规定。但是像我买的酷冷至尊毁灭者二代机箱，就不会叫，因为他没有蜂鸣器。

为什么会叫呢，这个我不懂，我不知道BIOS或者UEFI的检测原理，他如何检测出问题呢？这个我非常感兴趣，如果有听众知道，我非常想拜你为师。我对编程和硬件的东西都超级感兴趣，但是真不知道去哪里查资料。我现在只知道，要检查28项，这28项都要通过，才能进入下一个阶段。

找操作系统阶段

在主板检测到硬件没有问题以后，就开始进入下一个阶段，看看从哪里启动。在主板里，可以设置启动顺序，主要设置硬盘，光驱和U盘的顺序，先从哪块硬盘启动，如果有多块硬盘的话，也可以设置。如果装系统，可以选择从光驱或者U盘启动。此时，电脑按照这个排序，依次寻找启动设备，原理是读第一个扇区的前512个字节，如果这512个字节的最后两个字节是55和AA，那就说明可以启动。如果不是，就顺序寻找其它的启动设备。

写到这里，我发现不能再深入讲了，我写初稿的时候，写了好几页实模式怎么转换到保护模式下，后来发现，牵扯的东西太多了，包括CPU从实模式到保护模式的切换，引导程序如何把自己复制到内存的某个特定位置，讲下去会讲崩溃，首先太长，其次虽然我觉得有趣，但是大概别人觉得讲这个的肯定有毛病。简单来说，开机以后，CPU要要执行内存里的指令，内存指令的存放地址，刚开机的时候，都是放在固定的位置，CPU依次执行。其它的就不深入了。否则牛角尖钻的有点狠。  

为什么我们对底层硬件这么不了解？

我在写稿子读的时候，删除了大部分关于技术的，然后我想到了一个问题，现在不光是我，基本上所有的年轻人，即使学计算机，其实对底层也是非常的不熟悉。

当然，这不能怪大家，主要还是现在的没有深入研究底层的条件了。我记得当年我上学的时候，用turbo c来学习C语言，这个编译器跑在windows 95上，那时候用win32编程，只有一腔热血，其实啥也搞不出来，搞半天，敲一大堆代码，搞一个窗口出来，这个窗口啥也没有，就是一个纯粹的窗口。再敲半天代码，才能加上一个按钮。现在用编译器的话，鼠标拖一下，就可以添加一个按钮。非常方便，但是方便的代价，其实是你很难理解背后的原理了。


turbo c++ 的用户界面，大家体会一下

不光编程是这样，各行各业都是这样，比如汽车行业。在汽车刚刚发明的时候，你想开汽车，那得先学成一个机械师，非常的复杂。现在尤其是自动挡汽车出来以后，连换挡都不用。说实在的，我打开发动机的盖子，除了会添加个玻璃水，看看机油标尺，里面啥都不敢碰。然后再就是会换个轮胎。反而是我小的时候，天天蹲在修自行车的棚子那里，看修车的师傅修自行车，然后人家收摊了，我就把他不用的零件，就是一些小钢珠，小轴承捡回家，仔细研究。后来长大以后，如果是自行车链子断了，或者轮胎被扎了，我都能自己修好。我小学的时候就能自己用自行车的链条做火柴枪，我老家的土话叫洋火枪。


我能制作洋火枪

对计算机编程来说，现在的学生，我见过很多上完大学四年，对编程的理解仍然停留在Hello World的阶段。非常的初级，我认为这不能只怪学生，很大程度上，现在的电脑和手机集成化太高，根本没法深入研究。比如说，我们理解的手机和电脑，就是我拿来上网，我刷一下微博，或者上传个照片秀一下我新交的女朋友，结果上课的时候，老师讲的是：同学们，打开课本，这节课的内容是把20万个数据排一下序。

我知道算法很重要，但是感觉快速排序这个算法和我日常去发个微博这个应用场景差的还是有点远。比如说我喜欢汽车，就去报考了汽车系想学习如何造汽车，结果上课的时候老师说，同学们，我们这节课学习的内容是工程力学，我们先来讲一下四阶常微分方程，大部分人就懵逼了，我们都是俗人，我们心里知道常微分方程肯定很重要，但是，我们还是很难看到汽车发动机和梁的四阶常微分方程能有啥直接的关系，所以工程力学总是挂科很多。

计算机行业也是这样和现实有点脱节了，我们上课时候学习了太多重要的内容，比如最短路径算法，快速排序算法，各种平衡树，二叉树... 学霸当然能轻松搞定，游刃于现实的软件和理论的算法之间，而且游刃有余，但是，我属于学渣，就看不到我刷微博，发微信，和最短路径算法之间的联系。虽然，我知道后者好像也是软件的某种思想。

这就像我们从小被教育做社会主义的接班人，这是非常崇高的理想，在我幼小的心里，这就是拯救人类，和超人一样，要拯救全世界受苦受难的人，尤其是资本主义社会，美国日本那些受苦受难的小朋友，想起来，我现在都激动的想哭。理论上，或者说是教育上，我要做社会主义的接班人，但是到了现实中，差距很远，他们不让我当接班人，说这个接班人不是你的。我就觉得有点分裂，和计算机教育一样。书上学的，和现实中用的，不能很好的统一起来。我反正是看不到联系。

我想做点杯水车薪的事情

我这个微信公众号——软件那些事儿——订阅用户非常的少，经常好几天一个订阅者都没有，这已经是常态了，我也没法在乎了，毕竟一没有名气可以凭借，二没有鸡汤可以提供。为了能弥补计算机理论和现实之间的差距，我就想录一个视频，来讲一讲现实世界的软件开发。我是个老程序员，一直活跃在开发第一线，写过很多给企业，给个人的软件。

我在思考录什么视频的时候，当时考虑了两个思路，第一个思路是写一个比学校教编程底层一些，比如学校里直接就上JAVA了，我呢，写windows 平台的一个软件，比如说从最底层的API开始，比如我曾经用过的win32API开始，写出一个计算器来。不借助任何的库函数，就是使用C/C++语言，连MFC也不使用。最后写出一个计算器来。

第二个思路是，比学校教的高层一些，更加贴近我们实际的生活，比如写一个手机上的客户端，用来贴照片，或者从哪个网站上，比如微博上，把微博读取下来，然后提交到App Store上或者Google Play这种平台上。就是从0开始做出一个可以上架的免费的App。

我本来想，因为我这个公众号——软件那些事儿——已经获得了腾讯的认证，可以发表投票，想投个票，让大家选，毕竟有时候我也想嘚瑟一下，但是这个念头0.01秒就被我否决了，因为我的订阅用户太少了，最后的结果可能是0:0票，所以，我还是自己决定算了。我选择第二个方案，因为这个从0开始做个App上架，会更加时髦一些。

第一个方案最终的产品是个计算器，看起来很low，而且win32编程我也生疏了，win32编程需要不停的看手册，因为win32的API为了兼容，很多时候要传进去7-8个参数，然后查手册以后，微软告诉你，其中5-6个参数没有意义，仅仅是为了保持兼容，想想也很崩溃。我就做第二个方案吧，使用swift这个时髦的编程语言，写一个能够到苹果App Store上下载的免费产品，源代码到时候我就丢Github上。我不知道能做多少期，我觉得从0到上架，工作量应该不小。

具体写什么，我还没想好，我大概会根据一些优秀网站的API，来做一个客户端吧，希望我能坚持下去，即使没人看。到时候，我会把视频传到某个网站上，比如除了优酷的其它网站，因为以前我录过一个minecraft的游戏视频，当时我自己建了一个很大的红石电路，想录个视频嘚瑟一下，然后录了30分钟展示，上传优酷的时候，慢的不要不要的，最后也没有上传成功，作罢，如果大家有听到最后的，求推荐视频网站，免费的，不能我免费做视频，还得买会员上传的，这个太亏了。
